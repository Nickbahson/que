!function(){"use strict";var t,e,n=((e=n||{})[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED",e),i=((t=i||{})[t.INTERNAL=0]="INTERNAL",t[t.SERVER=1]="SERVER",t[t.CLIENT=2]="CLIENT",t[t.PRODUCER=3]="PRODUCER",t[t.CONSUMER=4]="CONSUMER",t);function s(t){return null==t?[]:Array.isArray(t)?t.map((t=>t.toString())):"string"==typeof t?t.split(/\n/g):[String(t)]}function o(t,e){let n=null;null!=(n=t.attributes["data-track"])&&null!=n.value&&""!==n.value&&(e.eventName=n.value)}function r(t,e){let n=[t.localName];if(!e&&t.dataset&&null!=t.dataset.track)n.push(`[data-track="${t.dataset.track}"]`);else{if(null!=t.id&&""!==t.id&&e)return[!1,`#${t.id}`];if(null!=t.id&&""!==t.id)n.push(`#${t.id}`);else for(let e=0;e<t.classList.length;e++)n.push(`.${t.classList[e]}`)}return[!0,n.join("")]}function a(){var t=(new Date).getTime(),e=typeof performance<"u"&&performance.now&&1e3*performance.now()||0;return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(n){var i=16*Math.random();return t>0?(i=(t+i)%16|0,t=Math.floor(t/16)):(i=(e+i)%16|0,e=Math.floor(e/16)),("x"===n?i:3&i|8).toString(16)}))}function h(){let t=a();return t.substring(0,t.length/2)}function l(){return a()}var c=(t,e,n=!1,i=365,s="/")=>{let o=new Date(Date.now()+864e5*i).toUTCString(),r=t+"="+encodeURIComponent(e)+"; expires="+o+"; path="+s+"; samesite=lax";n&&console.debug(`setCookie(name=${t}, value=${e}, days=${i}, path=${s}, expires=${o})`);try{document.cookie=r}catch{}},u=(t,e=!1,n="/")=>c(t,"",e,-1,n);function d(t,e,n,i=!1){return i&&console.debug(`subscribe(${e})`),t.addEventListener(e,n),()=>{t.removeEventListener(e,n)}}var p=t=>({ts:Date.now(),v:"2.0.0.1666786511242",m:y,t:"node",payload:t}),g=(t,e)=>async n=>{if(!("sendBeacon"in e))return f(t)(n);let i=p(n),s=JSON.stringify(i);e.sendBeacon(t,s)},f=t=>async e=>{let n=p(e),i=JSON.stringify(n);try{let e=await fetch(t,{method:"POST",headers:{"content-type":"application/json; charset=utf-8"},body:i});e.ok||console.debug("Could not send with fetch",e,await e.text())}catch(t){console.log("sendWithFetch error",t)}},_={cookieName:"cqid",cookieless:!1,disableTextCapture:!1,sendInterval:1e3,send:typeof window>"u"?f("https://api.causiq.com/v1/track"):g("https://api.causiq.com/v1/track",window.navigator)},m=class{constructor(t,e,n,i){this.config=_,this.c=t,this.root=n,this.name=e;let s=t.getSpanData();this._spanData={kind:2,attrs:{},...i,context:{spanId:h(),traceId:s.context.traceId,parentSpanId:s.context.spanId,traceFlags:s.context.traceFlags},name:e,ok:!0,start:Date.now()}}track(t,e,n){this.c.track(t,e,n||this._spanData.context)}navigate(t,e,n,i){this.c.navigate(t,e,n,i)}error(t,e={},n){this.c.error(t,e,n||this._spanData.context)}setPageProps(t){this.c.setPageProps(t)}setUserProps(t){this.c.setUserProps(t)}unsetUserProps(...t){this.c.unsetUserProps(...t)}getIdentity(){return this.c.getIdentity()}identify(t){this.c.identify(t)}resetIdentity(){return this.c.resetIdentity()}forgetUser(){this.c.forgetUser()}get parent(){return this.c}getSpanData(){return this._spanData}startSpan(t){return new m(this,t,this.root)}setAttribute(t,e){this._spanData.attrs[t]=e}setOk(t){this._spanData.ok=t}end(){let t=this._spanData;return t.end=Date.now(),this.root._push({m:this.root._moniker,t:Date.now(),n:"spanEnd",ps:[t],s:t.context,u:this.getIdentity()},!0),t}},w={sendWithFetch:f,sendWithBeacon:g,sendWithConsole:async t=>{for(let e of t){console.group(new Date(e.t).toLocaleTimeString()+" "+e.n);for(let t in e)console.log(t,"=",e[t]);console.groupEnd()}},composeSenders:function(...t){return async e=>{let n=t.filter((t=>null!=t));await Promise.all(n.map((t=>t(e))))}}},y="prod";(new class{constructor(t,e=!1){this.transport=t,this.verbose=e,this.V="2.0.0.1666786511242",this.T="node",this.M=y,this._config=_,this._inited=!1,this._disposable=[]}init(t,e,n){this._moniker="string"==typeof t?t:t.moniker,this._userId="string"==typeof t?n:t.userId;let i="string"==typeof t?e:t.config;this._config="object"==typeof i?{..._,...i}:null==i?_:i({..._,...i},w);let s="string"!=typeof t?t:void 0;this.verbose&&console.log("causiq.init called",this._moniker,"userId=",this._userId,i,"this.transport=",this.transport),this._inited&&console.warn("causiq.init called twice"),null==this.transport&&(this.transport=new class{constructor(t,e){this.sendInterval=t,this.sender=e,this._inbuf=[],this._start()}async push(t,e=!1){this._inbuf.push(t),e&&(await this._stop(),this._start())}async shutdown(){await this._stop()}_start(){let t=this._send.bind(this),e=setInterval(t,this.sendInterval);this._intervalId=e}async _stop(){this._intervalId&&clearTimeout(this._intervalId),this._intervalId=null,await this._send()}async _send(){if(0===this._inbuf.length)return;let t=Array.from(this._inbuf);this._inbuf=[],await this.sender(t)}}(this._config.sendInterval,this._config.send)),typeof window<"u"&&!this._config.cookieless&&_.cookieName!==this._config.cookieName&&u(_.cookieName),this._ensureRootSpan(null==s?void 0:s.span),this._inited||(this._disposable.forEach((t=>t())),this._disposable=[],this._disposable.push(function(t,e=!1){if(typeof window>"u")return e&&console.debug("msw: window is undefined"),()=>{};e&&console.info("msw: setting causiq on window"),window.causiq=t;let n=window.document,[i,s]=t._onVisibleOrLoad(window,"load"),o=d(n,"visibilitychange",(()=>{"hidden"===n.visibilityState?t._onHidden(window,"visibilitychange"):t._onVisibleOrLoad(window,"visibilitychange",i)}),e),r=d(n,"pagehide",(()=>t._onHidden(window,"pagehide")),e),a=d(window,"error",t.error.bind(t),e),h=d(window,"click",t._onClick.bind(t),e);return()=>{h(),a(),r(),o(),s()}}(this,this.verbose))),this._inited=!0}async shutdown(){if(this.end(),this._disposable.forEach((t=>t())),this._disposable=[],null!=this.transport){let t=this.transport;this.transport=void 0,await t.shutdown()}this.transport=void 0}get parent(){return null}_ensureRootSpan(t){if(this._rootSpan)return;let e=(null==t?void 0:t.context)??{spanId:h(),traceId:l(),traceFlags:1};this._rootSpan={name:typeof window>"u"?"root":window.location.pathname,start:Date.now(),kind:typeof window>"u"?1:2,ok:!0,attrs:{},...t,context:e}}getSpanData(t){let e=null==t?void 0:{traceId:t,spanId:h()};return this._ensureRootSpan({context:e}),this._rootSpan}startSpan(t,e){return new m(this,t,this,e)}setAttribute(t,e){this.getSpanData().attrs[t]=e}setOk(t){this.getSpanData().ok=t}end(){if(this.verbose&&console.log("end() called, rootSpan=",this._rootSpan),null==this._rootSpan)return console.error("span.end() called twice; so that this._rootSpan is null"),null;let t=this._rootSpan;return t.end=Date.now(),this._push({m:this._moniker,t:Date.now(),n:"spanEnd",ps:[t],s:t.context,u:this.getIdentity()},!0),this._rootSpan=void 0,t}track(t,e={},n){this._push({m:this._moniker,t:Date.now(),n:"track",ps:[t,e],s:n||this.getSpanData().context,u:this.getIdentity()})}navigate(t,e,n={},i){let s=i??this.getSpanData().context;this._push({m:this._moniker,t:Date.now(),n:"navigate",ps:[{prevHref:t,nextHref:e},n],s:s,u:this.getIdentity()}),this.end(),this._ensureRootSpan()}error(t,e={},n){if(null!=t){if(null!=this._rootSpan&&(this._rootSpan.ok=!1),"string"==typeof t)return this.track(t,{...e,error:!0},n);this._push({m:this._moniker,t:Date.now(),n:"error",ps:[(i=t,{name:i.name||i.constructor.name,colNo:i.colno,lineNo:i.lineno,fileName:i.filename,message:i.message,stack:s("Error"===i.constructor.name?i.stack:i.error.stack),path:(t=>null==t?null:Array.isArray(t)?t.map((t=>String(t))).join(","):t.constructor.name)(i.path)}),e],s:n||this.getSpanData().context,u:this.getIdentity()})}var i}setPageProps(t,e){this._push({m:this._moniker,t:Date.now(),n:"setPageProps",ps:[t],s:e||this.getSpanData().context,u:this.getIdentity()})}setUserProps(t,e){this._push({m:this._moniker,t:Date.now(),n:"setUserProps",ps:[t],s:e||this.getSpanData().context,u:this.getIdentity()})}unsetUserProps(...t){this._push({m:this._moniker,t:Date.now(),n:"unsetUserProps",ps:[t],s:this.getSpanData().context,u:this.getIdentity()})}_setIdentity(t,e){return this.verbose&&console.debug(`_setIdentity(${t}, cookieless=${e}) { this._config.cookieless => ${this._config.cookieless}; this._u => ${this._userId} }`),e||c(this._config.cookieName,t,this.verbose),this._userId=t}getIdentity(t=!1,e,n=!1){let i=t||this._config.cookieless,s=i?e:(r=this._config.cookieName,(()=>{try{return document.cookie}catch{return""}})().split("; ").reduce(((t,e)=>{let n=e.split("=");return n[0]===r?decodeURIComponent(n[1]):t}),"")??e),o=null==s||0===s.length;var r;return this.verbose&&console.debug(`getIdentity(cookieless=${t}, newId=${e}, forceSetIdentity=${n}) _u=${this._userId} cqid=${s} missingCookieUid=${o}`),o?this._setIdentity(this._userId??e??a(),i):this._userId=n?this._setIdentity(s,i):s}identify(t,e){let n=this.getIdentity(this._config.cookieless,t);this._setIdentity(t,this._config.cookieless),this._push({m:this._moniker,t:Date.now(),n:"identify",ps:[n,t],s:e||this.getSpanData().context,u:t})}resetIdentity(t=!1){return this.verbose&&console.log(`resetIdentity(cookieless=${t})`),t||u(this._config.cookieName,this.verbose),this._userId=void 0,this.getIdentity(t)}forgetUser(t){this._push({m:this._moniker,t:Date.now(),n:"forgetUser",ps:[this.getIdentity()],s:t||this.getSpanData().context,u:this.getIdentity()})}push(t){let e=Array.isArray(t)?t[0]:t.m,n=Array.isArray(t)?t.slice(1):t.ps,i=this[e];if(null!=i)return i.apply(this,n)}get length(){return 0}set length(t){}_push(t,e=!1){this.transport&&this.transport.push(t,e)}_onClick(t){let e=function(t,e,n){let i=e.target;if(null==i)return null;n=n||(t=>"input"!==t.nodeName);let s={};!t&&"innerText"in i&&null!=i.innerText&&""!==i.innerText&&n(i)&&(s.text=i.innerText.substring(0,50));let a=[];do{null==s.eventName&&o(i,s);let[t,e]=r(i,0===a.length);if(a.push(e),!t)break}while(null!=(i=i.parentElement)&&"body"!==i.localName);return s.cssSelector=a.reverse().join(" "),s}(this._config.disableTextCapture,t,this._config.shouldCaptureText);null!=e&&this._push({m:this._moniker,t:Date.now(),n:"clicked",ps:[e],s:this.getSpanData().context,u:this.getIdentity()})}_onVisibleOrLoad(t,e,n){if(typeof window>"u")throw new Error('_onVisible called, but "window" is undefined');if(typeof t.causiq>"u")return console.warn("Ensure you initialise Causiq!"),[l(),()=>{}];for(let e=0;e<t.causiq.length;e++)this.push(t.causiq[e]);t.causiq.length=0,t.causiq=this;let i=this.getSpanData(n).context,s=function(t,e){let n=t.location,i=t.navigator,s=new URL(n.href),o=(()=>{try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch{return null}})(),r=t=>s.searchParams.get(t),a={gclid:r("gclid"),href:n.href,pathname:n.pathname,title:e.title,clientWidth:Math.max(e.documentElement.clientWidth||0,t.innerWidth||0),clientHeight:Math.max(e.documentElement.clientHeight||0,t.innerHeight||0),userAgent:i.userAgent,deviceWidth:Math.max(t.screen.width,t.screen.availWidth),deviceHeight:Math.max(t.screen.height,t.screen.availHeight),referrer:""==e.referrer?null:e.referrer,timezone:o,datetimeOffset:(new Date).getTimezoneOffset(),vendor:""==i.vendor?null:i.vendor,languages:i.languages||[i.language]};for(let t of["source","medium","campaign","content","term"]){let e=r(`utm_${t}`);null!=e&&(a[`utm${t.substring(0,1).toUpperCase()}${t.substring(1)}`]=e)}return a}(t,t.document),o=this.getIdentity(this._config.cookieless,void 0,!0);return this._push({m:this._moniker,t:Date.now(),n:"pageVisible",ps:[e,s],s:i,u:o},!0),[i.traceId,()=>{}]}_onHidden(t,e){if(typeof window>"u")throw new Error('_onHidden called, but "window" is undefined');typeof t.causiq>"u"?console.warn("Ensure you initialise Causiq!"):this._push({m:this._moniker,t:Date.now(),n:"pageHidden",ps:[e],s:this.getSpanData().context,u:this.getIdentity()},!0)}}).init("CQ-H1A23LDP9ABC",(function(t,e){var n=e.sendWithConsole;return{send:"undefined"==typeof window?t.send:n}}))}();